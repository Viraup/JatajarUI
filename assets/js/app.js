(function(window,document,$){'use strict';$.app=$.app||{};var $body=$('body');var $window=$(window);$.app.url={encode:function(string){return escape(this._utf8_encode(string));},decode:function(string){return(string==null)?null:this._utf8_decode(unescape(string));},_utf8_encode:function(string){string=string.replace(/\r\n/g,'\n');var utftext='';for(var n=0;n<string.length;n++){var c=string.charCodeAt(n);if(c<128){utftext+=String.fromCharCode(c);}else if((c>127)&&(c<2048)){utftext+=String.fromCharCode((c>>6)|192);utftext+=String.fromCharCode((c&63)|128);}else{utftext+=String.fromCharCode((c>>12)|224);utftext+=String.fromCharCode(((c>>6)&63)|128);utftext+=String.fromCharCode((c&63)|128);}}return utftext;},_utf8_decode:function(utftext){var string='';var i=0;var c=0;var c1=0;var c2=0;var c3=0;while(i<utftext.length){c=utftext.charCodeAt(i);if(c<128){string+=String.fromCharCode(c);i++;}else if((c>191)&&(c<224)){c2=utftext.charCodeAt(i+1);string+=String.fromCharCode(((c&31)<<6)|(c2&63));i+=2;}else{c2=utftext.charCodeAt(i+1);c3=utftext.charCodeAt(i+2);string+=String.fromCharCode(((c&15)<<12)|((c2&63)<<6)|(c3&63));i+=3;}}return string;},Implode:function(glue,pieces){var i='',retVal='',tGlue='',j=0;if(arguments.length===1){pieces=glue;glue='';}if(typeof(pieces)==='object'){if(Object.prototype.toString.call(pieces)==='[object Array]'){return pieces.join(glue);}for(i in pieces){if(pieces[i]!=''){if(typeof(pieces[i])==='object'){for(var j in pieces[i]){if(pieces[i][j]!=''){retVal+=tGlue+i+'['+j+']='+pieces[i][j];tGlue=glue;}}}else{retVal+=tGlue+i+'='+pieces[i];tGlue=glue;}}}return retVal;}return pieces;},allParametr:function(){var ex_url=(document.location.href.split('?',2)[1]||'');if(ex_url.indexOf('?')!=-1){ex_url=ex_url.split('?')[1];}var paramsRaw=ex_url.split('&')||[];var extra_parametr={};for(var i=0;i<paramsRaw.length;i++){var single=paramsRaw[i].split('=');if(single[0]){extra_parametr[single[0]]=single[1];}}return extra_parametr;},getParameter:function(VarName){var par=$.app.url.allParametr();if(typeof par[VarName]!='undefined'){return par[VarName];}var return_val={};var matcher=new RegExp(VarName,"i");Object.keys(par).filter(key=>matcher.test(key)).forEach((key,index)=>return_val[index]=par[key]);return($.isEmptyObject(return_val))?null:return_val;},addParameter:function(VarName,VarValue){$.app.url.removeParameter(VarName);var allpar=$.app.url.allParametr();allpar[VarName]=VarValue;var par=$.app.url.Implode('&',allpar);var new_url=window.location.pathname+(par.length>0?'?'+par:'');history.replaceState(null,null,new_url);return true;},removeParameter:function(VarName,is_array=false){var oldallpar=$.app.url.allParametr();var allpar=$.app.url.allParametr();var matcher=new RegExp(VarName,"i");Object.keys(allpar).filter(key=>matcher.test(key)).forEach((key,index)=>delete allpar[key]);var par=$.app.url.Implode('&',allpar);var new_url=window.location.pathname+(par.length>0?'?'+par:'');if(Object.keys(oldallpar).length>Object.keys(allpar).length){history.replaceState(null,null,new_url);}return true;},removeParameterArr:function(VarNameObj,is_array=false){var oldallpar=$.app.url.allParametr();var allpar=$.app.url.allParametr();$.each(VarNameObj,function(idx,obj){var matcher=new RegExp(obj,"i");Object.keys(allpar).filter(key=>matcher.test(key)).forEach((key,index)=>delete allpar[key]);});var par=$.app.url.Implode('&',allpar);var new_url=window.location.pathname+(par.length>0?'?'+par:'');if(Object.keys(oldallpar).length>Object.keys(allpar).length){history.replaceState(null,null,new_url);}return true;},setUrl:function(new_url){var allpar=$.app.url.allParametr();var par=$.app.url.Implode('&',allpar);var new_url=new_url+(par.length>0?'?'+par:'');history.replaceState(null,null,new_url);return true;},findInputs:function(base){var params={};var count=0;var el_name;var el_val;$(base+' :input').each(function(index,o){if($(o).is(':checkbox:not(:checked)')||$(o).is(':radio:not(:checked)')){return true;}el_name=$(o).attr('name');if(typeof el_name!='undefined'){el_val=$(o).val();switch(o.type){case'select-multiple':params[el_name]={};$(base+' :input[name=\''+el_name+'\'] :selected').each(function(i,selected){params[el_name][i]=$(selected).val();});break;case'radio':if(el_name&&unescape(el_val)!=''){params[el_name]=unescape(el_val);}break;default:if($(base+' :input[name=\''+el_name+'\']').length>1){(typeof params[el_name]=='undefined')&&(count=1,params[el_name]={});params[el_name][count++]=unescape(el_val);}else{if(el_name&&unescape(el_val)!=''){params[el_name]=unescape(el_val);}}break;}}});return params;}};})(window,document,jQuery);