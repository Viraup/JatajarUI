var daterangepicker_format=$('html').attr('lang')=="fa"?"jYYYY/jMM/jDD":"DD/MM/YYYY";var datepicker_format=$('meta[name="datepicker_format"]').attr('content');var datedisplay_format=$('meta[name="datedisplay_format"]').attr('content');var current_refinement="Homes";var start=moment();var lang=$("html").attr('lang');$('.header_refinement').click(function(){current_refinement=$(this).attr('data');$(".header_refinement_input").val(current_refinement);$(".header_refinement").removeClass("active");$(this).addClass("active");guests_select_option("#modal_guests",current_refinement);guests_select_option("#header-search-guests",current_refinement);});guests_select_option("#modal_guests",current_refinement);guests_select_option("#header-search-guests",current_refinement);function guests_select_option(select,refinement){if(refinement=='Homes'){$(select+" option:gt(9)").removeAttr('disabled').show();}else{value=$(select).val();if(value-0>10){$(select+' option').removeAttr('selected')}$(select+" option:gt(9)").attr('disabled',true).hide();}}$(document).ready(function(){$('#header-search-checkin').attr('placeholder',datedisplay_format);$('#header-search-checkout').attr('placeholder',datedisplay_format);$('.holecheck').click(function(e){e.stopPropagation();})
$(document).mouseup(function(e){var container=$(".header-dropdown");if(!container.is(e.target)&&container.has(e.target).length===0){container.hide();}});$('#my-element').textfill({maxFontPixels:36});$('#host-profile-contact-btn').click(function(){$("body").addClass("pos-fix");});$('.modal-close').click(function(){$("body").removeClass("pos-fix");$('#ui-datepicker-div').hide();});$('#accept_submit').attr('disabled','disabled');$(document).on('click','#tos_confirm',function(){var $this=$(this);if($this.val()==0){$this.closest('#accept_reservation_form').find('#accept_submit').removeAttr('disabled');$this.val('1');}else{$this.closest('#accept_reservation_form').find('#accept_submit').attr('disabled','disabled');$this.val('0');}});$(document).on('click','#pre_approve_button',function(){$("div").remove(".alert-success");});var $alert=$('.alert[role="alert"]');if($alert.length>=1){$alert.on('close.bs.alert',function(e){e.preventDefault();var $alert=$(this);$alert.addClass('slide-out');setTimeout(function(){$alert.remove();},5000)});setTimeout(function(){$alert.addClass('slide-out');setTimeout(function(){$alert.remove();},5000)},5000);}});$(function(){var targets=$('[rel~=tooltip]'),target=false,tooltip=false,title=false;$(document).on('mouseenter','[rel~=tooltip]',function(){target=$(this);tip=target.attr('title');tooltip=$('<div id="tooltip1"></div>');if(!tip||tip=='')return false;target.removeAttr('title');tooltip.css('opacity',0).html(tip).appendTo('body');var init_tooltip=function(){if($(window).width()<tooltip.outerWidth()*1.5)tooltip.css('max-width',$(window).width()/2);else
tooltip.css('max-width',340);var pos_left=target.offset().left+(target.outerWidth()/2)-(tooltip.outerWidth()/2),pos_top=target.offset().top-tooltip.outerHeight()-20;if(pos_left<0){pos_left=target.offset().left+target.outerWidth()/2-20;tooltip.addClass('left');}else
tooltip.removeClass('left');if(pos_left+tooltip.outerWidth()>$(window).width()){pos_left=target.offset().left-tooltip.outerWidth()+target.outerWidth()/2+20;tooltip.addClass('right');}else
tooltip.removeClass('right');if(pos_top<0){var pos_top=target.offset().top+target.outerHeight();tooltip.addClass('top');}else
tooltip.removeClass('top');tooltip.css({left:pos_left,top:pos_top}).animate({top:'+=15',opacity:1},50);};init_tooltip();$(window).resize(init_tooltip);var remove_tooltip=function(){tooltip.animate({top:'-=15',opacity:0},50,function(){$(this).remove();});target.attr('title',tip);};target.bind('mouseleave',remove_tooltip);tooltip.bind('click',remove_tooltip);});});$(function(){$('.host_banner_content_slider_item').hide();$('#host_banner_content_slider_item_0').show();$("#host_banner_slider").responsiveSlides({auto:true,pager:false,nav:false,speed:2000,timeout:5000,namespace:"host_banner_slider_item",before:function(index){items_count=$("#host_banners_count").val();current_index=$('.'+this.namespace+'2_on').index();next_index=current_index+1;if(next_index>items_count){next_index=0;}$("#host_banner_content_slider_item_"+current_index).hide();$("#host_banner_content_slider_item_"+next_index).fadeIn(1000);},});});$(function(){$("#home_slider").responsiveSlides({auto:true,pager:false,nav:false,speed:2000,timeout:8000});$("#bottom_slider").responsiveSlides({auto:true,pager:false,nav:true,});});$("#bottom_slider").responsiveSlides({auto:true,speed:500,timeout:4000,pager:false,nav:true,random:false,pause:false,pauseControls:true,prevText:"Previous",nextText:"Next",maxwidth:"",navContainer:"",manualControls:"",namespace:"bottom_slider",before:function(){},after:function(){}});if($('.manage-listing-row-container').hasClass('has-collapsed-nav')===true){$('#js-manage-listing-nav').addClass('manage-listing-nav');}$('.js-show-how-it-works').click(function(){$(".js-how-it-works").slideToggle("fast",function(){$('.js-how-it-works').show();});});$('.js-close-how-it-works').click(function(){$(".js-how-it-works").slideToggle("fast",function(){$('.js-how-it-works').hide();});});$('#room-type-tooltip').mouseover(function(){$('.tooltip-room').show();});$('#room-type-tooltip').mouseout(function(){$('.tooltip-room').hide();});$('[id^="amenity-tooltip"]').on("mouseover",function(){var id=$(this).data('id');$('#ame-tooltip-'+id).show();});$('[id^="amenity-tooltip"]').on("mouseout",function(){$('[id^="ame-tooltip"]').hide();});$('.tool-amenity1').mouseover(function(){$('.tooltip-amenity1').show();});$('.tool-amenity1').mouseout(function(){$('.tooltip-amenity1').hide();});$('.tool-amenity2').mouseover(function(){$('.tooltip-amenity2').show();});$('.tool-amenity2').mouseout(function(){$('.tooltip-amenity2').hide();});$('a.become').mouseover(function(){$('.drop-down-menu-host').show();});$('a.become').mouseout(function(){$('.drop-down-menu-host').hide();});$('.trip-drop').mouseout(function(){$('.drop-down-menu-trip').hide();});$('.trip-drop').mouseover(function(){$('.drop-down-menu-trip').show();});$('.inbox-icon').mouseout(function(){$('.drop-down-menu-msg').hide();});$('.inbox-icon').mouseover(function(){$('.drop-down-menu-msg').show();});$('.drop-down-menu-host').mouseover(function(){$(this).show();});$('.drop-down-menu-host').mouseout(function(){$(this).hide();});$('.drop-down-menu-trip').mouseover(function(){$(this).show();});$('.drop-down-menu-trip').mouseout(function(){$(this).hide();});$('.drop-down-menu-msg').mouseover(function(){$(this).show();});$('.drop-down-menu-msg').mouseout(function(){$(this).hide();});$('#href_pricing').click(function(){$('#js-manage-listing-nav').removeClass('manage-listing-nav');$('#js-manage-listing-nav').addClass('pos-abs');$('#ajax_container').addClass('mar-left-cont');});$('#href_terms').click(function(){$('#js-manage-listing-nav').removeClass('manage-listing-nav');$('#js-manage-listing-nav').addClass('pos-abs');$('#ajax_container').addClass('mar-left-cont');});$('#remove-manage').click(function(){$('#js-manage-listing-nav').removeClass('manage-listing-nav');$('#js-manage-listing-nav').addClass('pos-abs');$('#ajax_container').addClass('mar-left-cont');});$('#href_booking').click(function(){$('#js-manage-listing-nav').removeClass('manage-listing-nav');$('#js-manage-listing-nav').addClass('pos-abs');$('#ajax_container').addClass('mar-left-cont');});$('#href_basics').click(function(){$('#js-manage-listing-nav').removeClass('manage-listing-nav');$('#js-manage-listing-nav').addClass('pos-abs');$('#ajax_container').addClass('mar-left-cont');});$('#href_description').click(function(){$('#js-manage-listing-nav').removeClass('manage-listing-nav');$('#js-manage-listing-nav').addClass('pos-abs');$('#ajax_container').addClass('mar-left-cont');});$('#href_location').click(function(){$('#js-manage-listing-nav').removeClass('manage-listing-nav');$('#js-manage-listing-nav').addClass('pos-abs');$('#ajax_container').addClass('mar-left-cont');});$('#href_amenities').click(function(){$('#js-manage-listing-nav').removeClass('manage-listing-nav');$('#js-manage-listing-nav').addClass('pos-abs');$('#ajax_container').addClass('mar-left-cont');});$('#href_photos').click(function(){$('#js-manage-listing-nav').removeClass('manage-listing-nav');$('#js-manage-listing-nav').addClass('pos-abs');$('#ajax_container').addClass('mar-left-cont');});$('#href_details').click(function(){$('#js-manage-listing-nav').removeClass('manage-listing-nav');$('#js-manage-listing-nav').addClass('pos-abs');$('#ajax_container').addClass('mar-left-cont');});$('#href_guidebook').click(function(){$('#js-manage-listing-nav').removeClass('manage-listing-nav');$('#js-manage-listing-nav').addClass('pos-abs');$('#ajax_container').addClass('mar-left-cont');});$('#href_calendar').click(function(){$('#js-manage-listing-nav').removeClass('manage-listing-nav');$('#js-manage-listing-nav').addClass('pos-abs');$('#ajax_container').addClass('mar-left-cont');});$('#UserMenuWrapper').click(function(e){$('#userDropDownMenu').toggle();});$('#header-avatar-trigger').click(function(e){e.preventDefault();});$('.header-become-host').click(function(e){e.preventDefault();$('.become_dropdown').toggle();});$('.login_popup_open').click(function(e){$('.become_dropdown').css('display','none');});var current_url=window.location.href.split('?')[0];var last_part=current_url.substr(current_url.lastIndexOf('/'));var last_part1=current_url.substr(current_url.lastIndexOf('/')+1);var header_autocomplete;var sm_autocomplete;$('#header-search-checkin').daterangepicker({minDate:start,jalaali:$('html').attr('lang')=='fa',opens:$('html').attr('lang')=='fa'?'left':'right',dateLimitMin:{"days":1},autoApply:true,autoUpdateInput:false});$('#header-search-checkin').on('apply.daterangepicker',function(ev,picker){startDateInput=$('input[name="checkin"]');endDateInput=$('input[name="checkout"]');startDate=picker.startDate;endDate=picker.endDate;$('#header-search-checkout').data('daterangepicker').setStartDate(startDate);$('#header-search-checkout').data('daterangepicker').setEndDate(endDate);startDateInput.val(startDate.format(daterangepicker_format));endDateInput.val(endDate.format(daterangepicker_format));$('#header-search-checkin').val(startDate.format(daterangepicker_format));$('#header-search-checkout').val(endDate.format(daterangepicker_format));});$('#header-search-checkout').daterangepicker({minDate:start,jalaali:$('html').attr('lang')=='fa',opens:$('html').attr('lang')=='fa'?'left':'right',dateLimitMin:{"days":1},autoApply:true,autoUpdateInput:false});$('#header-search-checkout').on('apply.daterangepicker',function(ev,picker){startDateInput=$('input[name="checkin"]');endDateInput=$('input[name="checkout"]');startDate=picker.startDate;endDate=picker.endDate;$('#header-search-checkin').data('daterangepicker').setStartDate(startDate);$('#header-search-checkin').data('daterangepicker').setEndDate(endDate);startDateInput.val(startDate.format(daterangepicker_format));endDateInput.val(endDate.format(daterangepicker_format));$('#header-search-checkin').val(startDate.format(daterangepicker_format));$('#header-search-checkout').val(endDate.format(daterangepicker_format));});$('#modal_checkin').daterangepicker({minDate:start,jalaali:$('html').attr('lang')=='fa',opens:$('html').attr('dir')=='rtl'?'left':'right',dateLimitMin:{"days":1,},autoApply:true,autoUpdateInput:false,singleDatePicker:true,linkedCalendars:false,});$('#modal_checkin').on('apply.daterangepicker',function(ev,picker){startDateInput=$('#modal_checkin');endDateInput=$('#modal_checkout');startDate=picker.startDate;endDate=picker.endDate;$('#modal_checkout').data('daterangepicker').setStartDate(startDate);$('#modal_checkout').data('daterangepicker').setEndDate(endDate);startDateInput.val(startDate.format(daterangepicker_format));});$('#modal_checkout').daterangepicker({minDate:start,jalaali:$('html').attr('lang')=='fa',opens:$('html').attr('dir')=='rtl'?'right':'left',dateLimitMin:{"days":1},autoApply:true,autoUpdateInput:false,singleDatePicker:true,linkedCalendars:false});$('#modal_checkout').on('apply.daterangepicker',function(ev,picker){startDateInput=$('#modal_checkin');endDateInput=$('#modal_checkout');startDate=picker.startDate;endDate=picker.endDate;$('#modal_checkin').data('daterangepicker').setStartDate(startDate);$('#modal_checkin').data('daterangepicker').setEndDate(endDate);endDateInput.val(endDate.format(daterangepicker_format));});$('#locationSearchForm [type="submit"]').on("click",function(e){e.preventDefault()
$(this).find(".parent-loader").show()
getResultCount("#locationSearchForm")})
$('#locationSearchForm').on('keyup keypress',function(e){var keyCode=e.keyCode||e.which;if(keyCode===13){$(this).find('.search-loader').show();$(this).closest('#locationSearchForm').submit();}});$('#submit_location_2').on('click',function(){$(this).find('.search-loader').show();$(this).closest('#locationSearchForm').submit();})
$('#location, #header-location--sm').keyup(function(){$('.searchbar__location-error').addClass('hide');});$('.search-form').submit(function(event){var header_checkin=moment($('input[name="checkin"]').val(),$('html').attr('lang')=='fa'?'jYYYY/jMM/jDD':'DD/MM/YYYY').format('DD/MM/YYYY');var header_checkout=moment($('input[name="checkout"]').val(),$('html').attr('lang')=='fa'?'jYYYY/jMM/jDD':'DD/MM/YYYY').format('DD/MM/YYYY');var header_guests=$('#header-search-guests').val();var header_room_type='';var sm_room_type='';var sm_cat_type='';$('.head_room_type').each(function(){if($(this).is(':checked'))sm_room_type+=$(this).val()+',';});$('.head_cat_type').each(function(){if($(this).is(':checked'))sm_cat_type+=$(this).val()+',';});sm_room_type=sm_room_type.slice(0,-1);sm_cat_type=sm_cat_type.slice(0,-1);var location=$('#header-search-form').val();var locations=location.replace(" ","+");window.location.href=APP_URL+'/search?location='+locations+'&checkin='+header_checkin+'&checkout='+header_checkout+'&guests='+header_guests+'&room_type='+sm_room_type+'&host_experience_category='+sm_cat_type+'&current_refinement='+current_refinement;event.preventDefault();});function submitMobSearh(){var location=$('#header-search-form-mob').val();if(location==''){$('.searchbar__location-error').removeClass('hide');return false;}else
$('.searchbar__location-error').addClass('hide');var sm_checkin=$('input[name="checkin"]').val()
var sm_checkout=$('input[name="checkout"]').val()
if(sm_checkin)sm_checkin=moment(sm_checkin,$('html').attr('lang')=='fa'?'jYYYY/jMM/jDD':'DD/MM/YYYY').format('DD/MM/YYYY');if(sm_checkout)sm_checkout=moment(sm_checkout,$('html').attr('lang')=='fa'?'jYYYY/jMM/jDD':'DD/MM/YYYY').format('DD/MM/YYYY');var sm_guests=$('#modal_guests').val();var sm_room_type='';var sm_cat_type='';$('.mob_room_type').each(function(){if($(this).is(':checked'))sm_room_type+=$(this).val()+',';});$('.mob_cat_type').each(function(){if($(this).is(':checked'))sm_cat_type+=$(this).val()+',';});sm_room_type=sm_room_type.slice(0,-1);sm_cat_type=sm_cat_type.slice(0,-1);var locations="";if(location){locations=location.replace(" ","+");}window.location.href=APP_URL+'/search?q='+locations+'&checkin='+sm_checkin+'&checkout='+sm_checkout+'&guests='+sm_guests+'&room_type='+sm_room_type+'&host_experience_category='+sm_cat_type+'&current_refinement='+current_refinement;};$(document).on('click','.menu-item',function(){var link=$(this).attr('href');if(link=='#'){$('body').removeClass('pos-fix');}});$('#header-search-settings').click(function(event){event.stopPropagation();});$('#ui-datepicker-div').click(function(event){event.stopPropagation();});$('.daterangepicker').click(function(event){event.stopPropagation();});function trigger_checkin(){$("#checkin").trigger("click");}if($(".searchbar").length){if(is_mobile){$('#checkin').daterangepicker({minDate:start,jalaali:$('html').attr('lang')=='fa',opens:$('html').attr('dir')=='rtl'?'left':'right',dateLimitMin:{"days":1,},autoApply:true,autoUpdateInput:false,singleDatePicker:true,linkedCalendars:true,},function(start,end,label){$('#checkin').val(end.format(daterangepicker_format));$('#checkin').data('daterangepicker').autoUpdateInput=true;startDateInput=$('input[name="checkin"]');endDateInput=$('input[name="checkout"]');var checkin_date_formatted=end.format(daterangepicker_format);startDateInput.val(checkin_date_formatted);var end_date=end.clone(),end_mindate=end_date.add(1,'day'),end_mindate_formatted=end_mindate.format(daterangepicker_format);var checkin=new moment(end);var checkout=new moment($('#checkout').data('daterangepicker').endDate);if(checkout<=checkin&&$('#checkout').val()!=''){$('#checkout').data('daterangepicker').setStartDate(end_mindate);startDateInput.val(end_mindate_formatted);$('#checkin').data('daterangepicker').maxDate=end;}$('#checkout').data('daterangepicker').minDate=end_mindate;});}else{$('#checkin').daterangepicker({minDate:start,jalaali:$('html').attr('lang')=='fa',opens:$('html').attr('dir')=='rtl'?'left':'right',dateLimitMin:{"days":1},autoApply:true,autoUpdateInput:false});$('#checkin').on('apply.daterangepicker',function(ev,picker){startDateInput=$('input[name="checkin"]');endDateInput=$('input[name="checkout"]');startDate=picker.startDate;endDate=picker.endDate;$('#checkout').data('daterangepicker').setStartDate(startDate);$('#checkout').data('daterangepicker').setEndDate(endDate);startDateInput.val(startDate.format(daterangepicker_format));endDateInput.val(endDate.format(daterangepicker_format));$('#checkin').val(startDate.format(daterangepicker_format));$('#checkout').val(endDate.format(daterangepicker_format));});}if(is_mobile){$('#checkout').daterangepicker({minDate:start,jalaali:$('html').attr('lang')=='fa',opens:$('html').attr('dir')=='rtl'?'left':'right',dateLimitMin:{"days":1,},autoApply:true,autoUpdateInput:false,singleDatePicker:true,linkedCalendars:true,},function(start,end,label){$('#checkout').val(end.format(daterangepicker_format));$('#checkout').data('daterangepicker').autoUpdateInput=true;startDateInput=$('input[name="checkin"]');endDateInput=$('input[name="checkout"]');var checkout_date_formatted=end.format(daterangepicker_format);endDateInput.val(checkout_date_formatted);var begin_date=end.clone(),begin_maxdate=begin_date.subtract(1,'day'),begin_maxdate_formatted=begin_maxdate.format(daterangepicker_format);var checkin=new moment($('#checkin').data('daterangepicker').endDate);$('#checkin').data('daterangepicker').maxDate=begin_maxdate;var checkin_date_formatted=checkin.format(daterangepicker_format);startDateInput.val(checkin_date_formatted);});}else{$('#checkout').daterangepicker({minDate:start,jalaali:$('html').attr('lang')=='fa',opens:$('html').attr('dir')=='rtl'?'right':'left',dateLimitMin:{"days":1},autoApply:true,autoUpdateInput:false});$('#checkout').on('apply.daterangepicker',function(ev,picker){startDateInput=$('input[name="checkin"]');endDateInput=$('input[name="checkout"]');startDate=picker.startDate;endDate=picker.endDate;$('#checkin').data('daterangepicker').setStartDate(startDate);$('#checkin').data('daterangepicker').setEndDate(endDate);startDateInput.val(startDate.format(daterangepicker_format));endDateInput.val(endDate.format(daterangepicker_format));$('#checkin').val(startDate.format(daterangepicker_format));$('#checkout').val(endDate.format(daterangepicker_format));});}}if(window.angular!=undefined){app.controller('payment',['$scope','$http',function($scope,$http){$('.open-coupon-section-link').click(function(){$("#billing-table").addClass("coupon-section-open");$('#restric_apply').hide();});$('.cancel-coupon').click(function(){$("#billing-table").removeClass("coupon-section-open");$('#restric_apply').show();$('#coupon_disabled_message').hide();});$('#apply-coupon').click(function(){var $apply_coupon_btn=$(this);var $delete_coupon_btn=$('#delete-coupon');var coupon_code=$('.coupon-code-field').val();var reservation_id=$('input#reservation_id').val();var sessionkey=$("input[name=session_key]").val();$apply_coupon_btn.attr('disabled','disabled');$delete_coupon_btn.attr('disabled','disabled');$http.post($(this).data('action'),{coupon_code:coupon_code,reservation_id:reservation_id,s_key:sessionkey}).then(function success(response){if(response.data.message){iziToast.show({message:response.data.message,position:'topRight',color:'rgba(28, 204, 35, 0.98)',messageColor:'#fff',rtl:$('html').attr('dir')=='rtl'?true:false,transitionIn:'bounceInLeft',});}if(response.data.success==true){$(".after_apply").hide();$(".after_apply_coupon").show();$delete_coupon_btn.show();$('.applied_coupen_amount').text(response.data.coupon_amount);$('.payment_total').text(response.data.total);if(typeof response.data.used_user_wallet!='undefined'){$('#user_wallet').show();$('.used_user_wallet').text(response.data.used_user_wallet);}else{$('#user_wallet').hide();}if(typeof response.data.used_organization_wallet!='undefined'){$('#organization_wallet').show();$('.used_organization_wallet').text(response.data.used_organization_wallet);}else{$('#organization_wallet').hide();}}else{$('.coupon-code-field').val('');}if(response.data.refresh==true){document.location.reload();}else{$apply_coupon_btn.removeAttr('disabled');$delete_coupon_btn.removeAttr('disabled');}},function error(response){$apply_coupon_btn.removeAttr('disabled');iziToast.show({message:response.data.message,position:'topRight',color:'rgba(183, 28, 28, 0.98)',messageColor:'#fff',rtl:$('html').attr('dir')=='rtl'?true:false,transitionIn:'bounceInLeft',});});});$('#delete-coupon').click(function(){var $apply_coupon_btn=$('#apply-coupon');var $delete_coupon_btn=$(this);var coupon_code=$('.coupon-code-field').val();var reservation_id=$('input#reservation_id').val();var sessionkey=$("input[name=session_key]").val();$apply_coupon_btn.attr('disabled','disabled');$delete_coupon_btn.attr('disabled','disabled');$http.post($(this).data('action'),{coupon_code:coupon_code,reservation_id:reservation_id,s_key:sessionkey}).then(function success(response){if(response.data.message){iziToast.show({message:response.data.message,position:'topRight',color:'rgba(28, 204, 35, 0.98)',messageColor:'#fff',rtl:$('html').attr('dir')=='rtl'?true:false,transitionIn:'bounceInLeft',});}if(response.data.success==true){$('.coupon-code-field').val('');$('.applied_coupen_amount').text('');$(".after_apply_coupon").hide();$delete_coupon_btn.hide();$('.payment_total').text(response.data.total);if(typeof response.data.used_wallet!='undefined'){$('.used_wallet').text(response.data.used_wallet);}}if(response.data.refresh==true){document.location.reload();}else{$apply_coupon_btn.removeAttr('disabled');$delete_coupon_btn.removeAttr('disabled');}},function error(response){$apply_coupon_btn.removeAttr('disabled');iziToast.show({message:response.data.message,position:'topRight',color:'rgba(183, 28, 28, 0.98)',messageColor:'#fff',rtl:$('html').attr('dir')=='rtl'?true:false,transitionIn:'bounceInLeft',});});});$('#remove_coupon').click(function(){$http.post(APP_URL+'/payments/remove_coupon',{}).then(function(response){window.location.reload();});});}]);}$(document).on('change','#payment-method-select',function(){if($(this).val()=='paypal'){$('#payment-method-cc').hide();$('.cc').hide();$('.'+$(this).val()).addClass('active');$('.'+$(this).val()).addClass('active');$('.'+$(this).val()+' > .payment-logo').removeClass('inactive');}else{$('#payment-method-cc').show();$('.cc').show();$('.paypal').removeClass('active');$('.paypal > .payment-logo').addClass('inactive');}$('[name="payment_method"]').val($(this).val());});$(document).ready(function(){setTimeout(function(){if($('#payment-method-select').val()=='paypal'){$('#payment-method-cc').hide();$('.cc').hide();$('.'+$('#payment-method-select').val()).addClass('active');$('.'+$('#payment-method-select').val()).addClass('active');$('.'+$('#payment-method-select').val()+' > .payment-logo').removeClass('inactive');}else{$('#payment-method-cc').show();$('.cc').show();$('.paypal').removeClass('active');$('.paypal > .payment-logo').addClass('inactive');}$('[name="payment_method"]').val($('#payment-method-select').val());},1000);});$('#country-select').change(function(){$('#billing-country').text($("#country-select option:selected").text());$('[name="country"]').val($(this).val());});$('#billing-country').text($("#country-select option:selected").text());$('[name="country"]').val($("#country-select option:selected").val());var previous_currency=$("#currency_footer").val();$("#language_footer, #currency_footer").on("change",function(e){lang_currency($(this));})
function lang_currency(option){var name=option.attr("name");var data;if(name==="currency"){data={currency:option.val(),previous_currency:previous_currency};}else if(name==="language"){data={language:option.val()};}else{return;}$.post(APP_URL+"/set_session",data,function(result,status){location.reload()
return;})}$(document).on('change','#user_profile_pic',function(){$('#ajax_upload_form').submit();});if(window.angular!=undefined){app.controller('listings_controller',['$scope','$http',function($scope,$http){$('#site-content').on('click','.disable-listing, .enable-listing',function(){var data_params={};data_params['status']=$(this).attr('data-status');var data=JSON.stringify(data_params);var id=$(this).attr('data-room-id');var row=$(this).closest('.listing.panel-body');row.find(".parent-loader").show();$http.post('listing-status/'+id+'/change_room_status',{data:{'status':$(this).attr('data-status')}}).then(function(response){row.html(response.data.listing);});});$('#site-content').on('click','.listing-filter',function(){var data_params={};var _filter=$(this).attr('data-filter');var $parent=$('#site-content > .page-container-responsive');$parent.find("> .parent-loader").show();$http.post('rooms',{data:_filter}).then(function(response){$parent.html(response.data.listings);});});}]);app.controller('reviews',['$scope','$http',function($scope,$http){$('li > .tab-item').click(function(){var tab_name=$(this).attr('aria-controls');var tab_selected=$(this).attr('aria-selected');if(tab_selected=='false'){$('.tab-item').attr('aria-selected','false');$(this).attr('aria-selected','true');$('.tab-panel').hide();$('#'+tab_name).show();}});}]);app.controller('help',['$scope','$http',function($scope,$http){$('.help_nav .navtree-list .navtree-next').click(function(){var id=$(this).data('id');var name=$(this).data('name');$('.help_nav #navtree').css({'left':'-300px'});$('.help_nav .subnav-list li:first-child a').attr('aria-selected','false');$('.help_nav .subnav-list li').append('<li> <a class="subnav-item" href="#" data-node-id="0" aria-selected="true"> '+name+' </a> </li>');$('.help_nav #navtree-'+id).css({'display':'block'});});$('.help_nav .navtree-list .navtree-back').click(function(){var id=$(this).data('id');var name=$(this).data('name');$('.help_nav #navtree').css({'left':'0px'});$('.help_nav .subnav-list li:first-child a').attr('aria-selected','true');$('.help_nav .subnav-list li').last().remove();$('.help_nav #navtree-'+id).css({'display':'none'});});$('#help_search').autocomplete({source:function(request,response){$.ajax({url:APP_URL+"/ajax_help_search",type:"GET",dataType:"json",data:{term:request.term},success:function(data){response(data);$(this).removeClass('ui-autocomplete-loading');}});},search:function(){$(this).addClass('loading');},open:function(){$(this).removeClass('loading');}}).autocomplete("instance")._renderItem=function(ul,item){if(item.id!=0){$('#help_search').removeClass('ui-autocomplete-loading');return $("<li>").append("<a href='"+APP_URL+"/help/article/"+item.id+"/"+item.question+"' class='article-link article-link-panel link-reset'><div class='hover-item__content'><div class='col-middle-alt article-link-left'><i class='icon icon-light-gray icon-size-2 article-link-icon icon-description'></i></div><div class='col-middle-alt article-link-right'>"+item.value+"</div></div></a>").appendTo(ul);}else{$('#help_search').removeClass('ui-autocomplete-loading');return $("<li style='pointer-events: none;'>").append("<span class='article-link article-link-panel link-reset'><div class='hover-item__content'><div class='col-middle-alt article-link-left'><i class='icon icon-light-gray icon-size-2 article-link-icon icon-description'></i></div><div class='col-middle-alt article-link-right'>"+item.value+"</div></div></span>").appendTo(ul);}};}]);app.controller('reviews_edit_host',['$scope','$http',function($scope,$http){$('.next-facet').click(function(){$('#double-blind-copy').addClass('hide');$('#host-summary').removeClass('hide');$('#guest').removeClass('hide');});$('.exp_review_submit').click(function(){var section=$(this).parent().parent().attr('id');var data_params={};$('#'+section+'-form input, #'+section+' textarea').each(function(){if($(this).attr('type')!='radio'){data_params[$(this).attr('name')]=$(this).val();}else{if($(this).is(':checked'))data_params[$(this).attr('name')]=$(this).val();}});var id=$('#reservation_id').val();if(section=='host-summary'||section=='guest'){if($('#review_comments').val()==''){$('[for="review_comments"]').show();$('#review_comments').addClass('invalid');return false;}else{$('[for="review_comments"]').hide();$('#review_comments').removeClass('invalid');}if(section=='host-summary'){if(!$('[name="rating"]').is(':checked')){$('[for="review_rating"]').show();return false;}else
$('[for="review_rating"]').hide();}}data_params['review_id']=$('#review_id').val();var data=JSON.stringify(data_params);$('.review-container').addClass('loading');$http.post(APP_URL+'/host_experience_reviews/edit/'+id,{data:data}).then(function(response){$('.review-container').removeClass('loading');if(response.data.success){window.location.href=APP_URL+'/users/reviews';}});})
$('.review_submit').click(function(){var section=$(this).parent().parent().attr('id');var data_params={};$('#'+section+'-form input, #'+section+' textarea').each(function(){if($(this).attr('type')!='radio'){data_params[$(this).attr('name')]=$(this).val();}else{if($(this).is(':checked'))data_params[$(this).attr('name')]=$(this).val();}});var id=$('#reservation_id').val();if(section=='host-summary'||section=='guest'){if($('#review_comments').val()==''){$('[for="review_comments"]').show();$('#review_comments').addClass('invalid');return false;}else{$('[for="review_comments"]').hide();$('#review_comments').removeClass('invalid');}if(section=='host-summary'){if(!$('[name="rating"]').is(':checked')){$('[for="review_rating"]').show();return false;}else
$('[for="review_rating"]').hide();}}data_params['review_id']=$('#review_id').val();var data=JSON.stringify(data_params);$('.review-container').addClass('loading');$http.post(APP_URL+'/reviews/edit/'+id,{data:data}).then(function(response){$('.review-container').removeClass('loading');if(response.data.success){if(section=='host-details'||section=='guest')window.location.href=APP_URL+'/users/comments';$('#review_id').val(response.data.review_id);$('#'+section).addClass('hide');$('#'+section).next().removeClass('hide');}});});$('#host-details-form > .btn-secondary').on('click',function(e){e.preventDefault();$('#host-summary').removeClass('hide');$('#host-details').addClass('hide');$('html, body').animate({"scrollTop":0},400);})}]);app.controller('cancel_reservation',['$scope','$http',function($scope,$http){$("[id$='-trigger']").click(function(){var reservation_id=$(this).attr('id').replace('-trigger','');if(reservation_id!='header-avatar'){$("#reserve_code").val(reservation_id);$("#reserve_id").val(reservation_id);var id='#cancel-modal';var data_params={};data_params['id']=reservation_id;var data=JSON.stringify(data_params);$http.post(APP_URL+'/reservation/cencel_request_send',{data:data}).then(function(response){if(response.data.success=='false'){var id='#cancel-modal';$(id).removeClass('hide');$(id).addClass('show');$(id).attr('aria-hidden','false');}else{location.reload();}});}});$("[id$='-trigger-pending']").click(function(){var reservation_id=$(this).attr('id').replace('-trigger-pending','');$("#reserve_code_pending").val(reservation_id);$("#reserve_id").val(reservation_id);var id='#pending-cancel-modal';$(id).removeClass('hide');$(id).addClass('show');$(id).attr('aria-hidden','false');});$('[data-behavior="modal-close"]').click(function(event){event.preventDefault();$('.modal').removeClass('show');$('.modal').attr('aria-hidden','true');$('body').removeClass('pos-fix');});$scope.dispute_form_errors=[];$scope.trigger_create_dispute=function(reservation_data){$scope.dispute_reservation_data=reservation_data;$scope.dispute_form_errors=[];$('body').addClass('pos-fix');$('#dispute_modal').removeClass('hide').addClass('show').attr('aria-hidden','false');}
$scope.submit_create_dispute=function(){$("#dipute_form_content").addClass('loading');$http({method:'POST',url:APP_URL+'/disputes/create',headers:{'Content-Type':'multipart/form-data'},data:$scope.dispute_reservation_data,transformRequest:function(data,headersGetter){var formData=new FormData();angular.forEach(data,function(value,key){if(jQuery.type(value)=='object'){$.each(value,function(i,val){formData.append(key+"[]",val);});}else{formData.append(key,value);}});var headers=headersGetter();delete headers['Content-Type'];return formData;}}).success(function(response){if(response.status=='error'){$scope.dispute_form_errors=response.errors;}else{$scope.dispute_form_errors=[];window.location.reload();if(response.status=='success'){return;}}$("#dipute_form_content").removeClass('loading');}).error(function(data,status){$scope.dispute_form_errors=[];$("#dipute_form_content").removeClass('loading');});}}]);app.directive('file',function(){return{scope:{file:'='},link:function(scope,el,attrs){el.bind('change',function(event){var file=event.target.files;scope.file=file?file:undefined;scope.$apply();});}};});app.controller('Tabsh',['$scope',function($scope){$scope.show=1;$scope.tab1=true;}]);}var rtl=false;if(lang=='ar'){rtl=true;}$(document).ready(function(){$(document).on('click',".sidebarbar",function(){$('.main_bar').toggleClass('newmain');$('.het').toggleClass('het1');});$('.list-your-space > .host-btn, #hostNewRoom').on('click',function(e){if($(this).hasClass('login_popup_open')){$('#redirectInput').val('rooms/new');}})
$(document).scroll(function(){var width1=$(window).width();if(width1>767){return true;}var dtg=$(this).scrollTop();if(dtg>100){$('.mobover').fadeIn();}else{$('.mobover').fadeOut();}});$("#ftb, #ftbm").click(function(){$(".home_pro").show();$(".exp_cat").hide();});$("#ftb1, #ftbm1").click(function(){$(".exp_cat").show();$(".home_pro").hide();});if(!!is_mobile){$(window).scroll(function(){var fixSidebar=$('.makent-header.new').innerHeight();var sidebarHeight=$('.tespri').height();if($(window).scrollTop()>=fixSidebar){$('.tespri').addClass('fixed');$('.listing-nav-sm').addClass('sidenv');$('.manage-listing-row-container').addClass('fixset');}else{$('.tespri').removeClass('fixed');$('.listing-nav-sm').removeClass('sidenv');$('.manage-listing-row-container').removeClass('fixset');}});}$('.hm_slide1').owlCarousel({loop:false,margin:20,rtl:rtl,responsiveClass:true,responsive:{0:{items:1,nav:true},425:{items:2,nav:true},736:{items:3,nav:true},992:{items:3,nav:true},1025:{items:4,nav:true}}});$(window).on("load",function(){$("#content-1").mCustomScrollbar({theme:"minimal"});});$(window).on("load",function(){$("#content-3").mCustomScrollbar({theme:"minimal"});});$('#contact-host-link').click(function(){$("body").addClass("pos-fix3");});$('.mod_cls').click(function(){$("body").removeClass("pos-fix3");});$('.pop-striped').click(function(){$("body").addClass("pos-fix3");});$('.panel-close').click(function(){$("body").removeClass("pos-fix3");});$('.ser_mobtab').click(function(){$("body").addClass("pos-fix3");});$('.modal-close').click(function(){$("body").removeClass("pos-fix3");});});function res_menu(){$('#helpMenu').click(function(){$('.sub_menu_header').toggleClass('open');});};var count=1;$(document).ready(function(){if($('#site-content').attr('data-action')=="login")$('.login_popup').toggle();$("body").on("DOMSubtreeModified",".saPrice",function(e){setTimeout(function(){count=1},4000)
if(count==1)setTimeout(saPrice2,1000)
count++})
saPrice2();var S_mobile=$("#signin_mobile_lable");var S_email=$("#signin_email_lable");$("#signin_mobile").keyup(function(){signinDetect($(this),S_mobile,S_email)})
$("#signin_email").keyup(function(){signinDetect($(this),S_email,S_mobile)})
function signinDetect(elm,Act,Dis){if(elm.val().trim().length){Act.addClass('active')
Dis.addClass('disable').find('input').prop("disabled",true)}else if(elm.val().trim().length==0){elm.val('');Act.removeClass('active')
Dis.removeClass('disable').find('input').prop("disabled",false)}}$("#user_birthday_month,#user_birthday_day,#user_birthday_year,#user_birthday_month1,#user_birthday_day1,#user_birthday_year1").on('change',function(){if(lang=='fa'){var day=$("#user_birthday_day").val()?$("#user_birthday_day").val():$("#user_birthday_day1").val();var month=$("#user_birthday_month").val()?$("#user_birthday_month").val():$("#user_birthday_month1").val();var year=$("#user_birthday_year").val()?$("#user_birthday_year").val():$("#user_birthday_year1").val();var birthday=moment(year+'/'+month+'/'+day,'jYYYY/jM/jD');$('[name="birthday_year"]').val(birthday.format('YYYY'));$('[name="birthday_month"]').val(birthday.format('M'));$('[name="birthday_day"]').val(birthday.format('D'));}});function convertDate(){if(lang=='fa'){var elm=$(this);var td=elm.text();td=td.split("-");td=moment(td[0],'D/M/YYYY').format('jYYYY/jM/jD')+' – '+moment(td[1],'D/M/YYYY').format('jYYYY/jM/jD');elm.text(td);}}$(".s-date").map(dateConverter2)
$(".s-date-ym").map(shortConvert)
$(".s-date-range").map(convertDate)
if(lang=='fa'){$(".s-date-dashed").map(dateConverterDashed)}var day=$('#update_form [name="birthday_day"]').val();var month=$('#update_form [name="birthday_month"]').val();var year=$('#update_form [name="birthday_year"]').val();if(day||month||year){var birthday=moment(year+'/'+month+'/'+day,'YYYY/MM/DD');$('#update_form #user_birthday_day5').val(birthday.format("jD"));$('#update_form #user_birthday_month5').val(birthday.format("jM"));$('#update_form #user_birthday_year5').val(birthday.format("jYYYY"));}$("#user_birthday_day5,#user_birthday_month5,#user_birthday_year5").on("change",function(){if(lang=="fa")persianBirthday({day:$('#update_form #user_birthday_day5'),month:$('#update_form #user_birthday_month5'),year:$('#update_form #user_birthday_year5'),},{day:$('#update_form [name="birthday_day"]'),month:$('#update_form [name="birthday_month"]'),year:$('#update_form [name="birthday_year"]')})})});function dateConverter(){var elm=$(this);var date;date=moment(elm.text().trim());if(date.isValid()&&lang=='fa'){date=date.format('jYYYY/jM/jD')
elm.text(date);}}function dateConverter2(){if(lang=='fa'){var elm=$(this);var td=elm.text();td=moment(td,'D/M/YYYY').format('jYYYY/jM/jD');elm.text(td);}}function dateConverterDashed(){var elm=$(this);var td=elm.text();td=moment(td,'YYYY-M-D').format('jYYYY/jM/jD');elm.text(td);}function shortConvert(){var elm=$(this)
var date;date=moment(elm.text())
if(date.isValid()&&lang=='fa'){date=date.format('jMMMM jYYYY')
elm.text(date);}}function persianBirthday(getter,setter){var day=getter.day.val()
var month=getter.month.val()
var year=getter.year.val()
var birthday=moment(year+'/'+month+'/'+day,'jYYYY/jM/jD');setter.day.val(birthday.format('D'))
setter.month.val(birthday.format('M'))
setter.year.val(birthday.format('YYYY'))}saPrice2();function saPrice(){var elm=$(this);elm.text(elm.text().replace(/\d{1,3}(?=(\d{3})+(?!\d))/g,'$&,'));}function saPrice2(){var elm=$("body").find('.saPrice');if(elm.length==1)elm.text(elm.text().replace(/\d{1,3}(?=(\d{3})+(?!\d))/g,'$&,'));else if(elm.length>1)elm.map(saPrice);}function digitsToEnglish(digits){var numTb={"۰":"0","۱":"1","۲":"2","۳":"3","۴":"4","۵":"5","۶":"6","۷":"7","۸":"8","۹":"9"}
return digits.replace(/[۰-۹]/g,function(m){return numTb[m];})}function checkMelliCode(meli_code){if(meli_code.length==10){if(meli_code=='1111111111'||meli_code=='0000000000'||meli_code=='2222222222'||meli_code=='3333333333'||meli_code=='4444444444'||meli_code=='5555555555'||meli_code=='6666666666'||meli_code=='7777777777'||meli_code=='8888888888'||meli_code=='9999999999'){return false;}c=parseInt(meli_code.charAt(9));n=parseInt(meli_code.charAt(0))*10+parseInt(meli_code.charAt(1))*9+parseInt(meli_code.charAt(2))*8+parseInt(meli_code.charAt(3))*7+parseInt(meli_code.charAt(4))*6+parseInt(meli_code.charAt(5))*5+parseInt(meli_code.charAt(6))*4+parseInt(meli_code.charAt(7))*3+parseInt(meli_code.charAt(8))*2;r=n-parseInt(n/11)*11;if((r<=1&&r==c)||(r>1&&c==11-r)){return true;}else{return false;}}else{return false;}}function submitPaymentForm(elm=false){var url=window.location.href
var opts=(elm)?$(elm).val():$('[name="paymentOP"]').val()
url=url.split("&pm")[0]+"&pm="+opts
var passport=$('[name="passport"]')
var idcode=$('[name="idcode"]')
var firstN=$('[name="firstName"]')
var lastN=$('[name="lastName"]')
url+="&first_name="+firstN.val()+"&last_name="+lastN.val()
if(idcode.val().length>0){idcode="&id_code="+idcode.val()
window.location.href=url+idcode}else if(passport.val().length>0){passport="&passport="+passport.val()
window.location.href=url+passport}}$(function(){if(lang==='fa'){$('form').on('keyup input','input[type="tel"]',function(e){$(this).val($(this).val().replace(/[٠١٢٣٤٥٦٧٨٩]/g,function(d){return d.charCodeAt(0)-1632;}));})}var $locationSearchForm=$('#locationSearchForm'),$propertySearchForm=$('#propertySearchForm'),$search_by_property=$('#search_by_property'),$search_by_location=$('#search_by_location');$('#search_by_location').on('click',function(e){$search_by_property.removeClass('activeSearch');$search_by_location.addClass('activeSearch');$propertySearchForm.hide();$locationSearchForm.show();$('#propertySearch').hide();$('#mobLocSearch').show();})
$('#search_by_property').on('click',function(e){$search_by_location.removeClass('activeSearch');$search_by_property.addClass('activeSearch');$locationSearchForm.hide();$propertySearchForm.show();$('#mobLocSearch').hide();$('#propertySearch').show();})
$('.ui-datepicker-target, #header-search-form-mob, #modal_guests').on('click',function(){$('.input-clicked').removeClass('input-clicked');$(this).addClass('input-clicked');$('.daterangepicker > .calendar:visible').css({'display':'table-cell'});})
var langID=$('#language_footer.b-bottom-select').find(':selected').val();var $langSelect=$('#langSelect').find('#language_footer');switch(langID){case"fa":$langSelect.addClass('fa-flag');break;case"en":$langSelect.addClass('en-flag');break;case"ar":$langSelect.addClass('ar-flag');break;}})
function debounce(func,wait,immediate){var timeout;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)func.apply(context,args);};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)func.apply(context,args);};};$(document).on('click','#cancel_submit',function(e){e.preventDefault();$(this).parents('.modal-content').find('.parent-loader').show();$(this).parents('#cancel_reservation_form').submit();})
var trip_timer={},$expired_msg=$('#expire_msg').val(),timer_arr=[],seconds_left={};$('.trip-timer').each(function(k,v){var $this=$(this),indexKey=+$this.find('#indexKey').val();$this.text(reservation_countdown(indexKey,$this.find('.timer-created-at').val(),$('#trip_'+indexKey).val()))})
function reservation_countdown(timerID,distance,trip_id){var _second=1;var _minute=_second*60;var _hour=_minute*60;var _day=_hour*24;seconds_left[timerID]=distance;trip_timer[timerID]=setInterval(showRemaining,1000,timerID,_day,_hour,_minute,_second,trip_id);}function showRemaining(timerID,_day,_hour,_minute,_second,trip_id){seconds_left[timerID]-=1;if(seconds_left[timerID]<0){clearInterval(trip_timer[timerID]);$('.timer-'+timerID).parent().html($expired_msg);var $row=$('#trip_'+trip_id);$row.find('.parent-loader').show();$.ajax({url:APP_URL+'/reservation/expire/'+trip_id+'?is_trips=true',dataType:'json',type:'POST',headers:{'X-Requested-With':'XMLHttpRequest'},success:function(responce){iziToast.show({message:responce.msg,position:'topRight',color:'rgba(28, 204, 35, 0.98)',messageColor:'#fff',rtl:$('html').attr('dir')=='rtl'?true:false,transitionIn:'bounceInLeft',});$row.html(responce.row);$('#trip_'+trip_id).find(".s-date").map(dateConverter2)},})
return;}var days=Math.floor(seconds_left[timerID]/_day);var hours=Math.floor((seconds_left[timerID]%_day)/_hour);var minutes=Math.floor((seconds_left[timerID]%_hour)/_minute);var seconds=Math.floor((seconds_left[timerID]%_minute)/_second);var timer=(hours<10?'0'+hours:hours)+':'+(minutes<10?'0'+minutes:minutes)+':'+(seconds<10?'0'+seconds:seconds);$('.timer-'+timerID).text(timer);}